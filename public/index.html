<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cadastro de Clientes - CRM Profissional</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <nav class="navbar navbar-light bg-light shadow-sm">
    <div class="container max-w-7xl d-flex align-items-center">
      <a class="navbar-brand font-bold text-gray-900" href="index.html">CRM Profissional</a>
      <div class="ms-auto d-flex gap-3">
        <a class="nav-link active" aria-current="page" href="index.html">Clientes</a>
        <span class="nav-link text-muted">Ocorrências</span>
        <a class="nav-link" href="ocorrencias-gestor.html">Ocorrências Gestor</a>
        <a class="nav-link" href="historico-ocorrencias.html">Histórico de Ocorrências</a>
        <a class="nav-link" href="login.html">Login</a>
      </div>
    </div>
  </nav>
  
  <div class="container mt-8 max-w-7xl mx-auto px-4">
    <h1 class="text-3xl font-extrabold text-gray-900 mb-6">Cadastro de Clientes</h1>

    <div class="flex flex-wrap items-center mb-4 gap-3">
      <button class="btn btn-success flex items-center gap-2" onclick="abrirModal()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>
        Adicionar Cliente
      </button>

      <button class="btn btn-primary flex items-center gap-2" onclick="document.getElementById('fileInput').click()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-input-icon lucide-file-input"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M2 15h10"/><path d="m9 18 3-3-3-3"/></svg>
        Importar Clientes
      </button>
      <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="importarClientes(this.files)" />

      <button class="btn btn-danger flex items-center gap-2" onclick="exportarPDF()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-down-icon lucide-file-down"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M12 18v-6"/><path d="m9 15 3 3 3-3"/></svg>
        Exportar PDF
      </button>

      <button class="btn btn-warning flex items-center gap-2" onclick="exportarJSON()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-json2-icon lucide-file-json-2"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M4 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1"/><path d="M8 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1"/></svg>
        Exportar JSON
      </button>
      
      <input type="text" id="filtroInput" placeholder="Buscar cliente..." 
        class="form-control rounded-md border border-gray-300 px-3 py-2 w-full max-w-xs"
        oninput="filtrarClientes()" />
    </div>

    <div class="table-container">
      <table class="table table-bordered table-hover min-w-full bg-white">
        <thead>
          <tr>
            <th>Código</th>
            <th>Nome/Apelido</th>
            <th>Razão Social</th>
            <th>CPF/CNPJ</th>
            <th>Regime Fiscal</th>
            <th>Situação</th>
            <th>Tipo Pessoa</th>
            <th>Estado</th>
            <th>Município</th>
            <th>Status</th>
            <th>Possui I.E.?</th>
            <th>I.E.</th>
            <th>Filial</th>
            <th>Matriz</th>
            <th>Grupo</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody id="clientesBody"></tbody>
      </table>
    </div>

    <div class="flex justify-between items-center mt-4">
      <div>
        <span id="paginacaoInfo" class="text-gray-600"></span>
      </div>
      <div class="flex gap-2">
        <button class="btn btn-outline-secondary" onclick="irParaPrimeiraPagina()">Primeira</button>
        <button class="btn btn-outline-secondary" onclick="irParaPaginaAnterior()">Anterior</button>
        <button class="btn btn-outline-secondary" onclick="irParaProximaPagina()">Próxima</button>
        <button class="btn btn-outline-secondary" onclick="irParaUltimaPagina()">Última</button>
      </div>
    </div>
  </div>

  <!-- Modal para cadastro/edição -->
  <div class="modal fade" id="clienteModal" tabindex="-1" aria-labelledby="clienteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <form id="clienteForm" class="modal-content">
        <div class="modal-header bg-green-500 text-white">
          <h5 class="modal-title" id="clienteModalLabel">Adicionar Cliente</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3">
            <div class="col-md-6">
              <label for="codigo" class="form-label fw-semibold">Código Interno <span class="text-danger">*</span></label>
              <input type="text" id="codigo" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label for="nome" class="form-label fw-semibold">Nome/Apelido <span class="text-danger">*</span></label>
              <input type="text" id="nome" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label for="razao_social" class="form-label fw-semibold">Razão Social</label>
              <input type="text" id="razao_social" class="form-control" />
            </div>
            <div class="col-md-6">
              <label for="cpf_cnpj" class="form-label fw-semibold">CPF/CNPJ <span class="text-danger">*</span></label>
              <input type="text" id="cpf_cnpj" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label for="regime_fiscal" class="form-label fw-semibold">Regime Fiscal</label>
              <select id="regime_fiscal" class="form-select">
                <option value="Simples Nacional">Simples Nacional</option>
                <option value="Lucro Presumido">Lucro Presumido</option>
                <option value="Lucro Real">Lucro Real</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="situacao" class="form-label fw-semibold">Situação</label>
              <select id="situacao" class="form-select">
                <option value="Ativo">Ativo</option>
                <option value="Inativo">Inativo</option>
                <option value="Pendente">Pendente</option>
                <option value="Bloqueado">Bloqueado</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="tipo_pessoa" class="form-label fw-semibold">Tipo de Pessoa</label>
              <select id="tipo_pessoa" class="form-select">
                <option value="Física">Física</option>
                <option value="Jurídica">Jurídica</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="estado" class="form-label fw-semibold">Estado</label>
              <select id="estado" class="form-select">
                <option value="AC">Acre</option>
                <option value="AL">Alagoas</option>
                <option value="AP">Amapá</option>
                <option value="AM">Amazonas</option>
                <option value="BA">Bahia</option>
                <option value="CE">Ceará</option>
                <option value="DF">Distrito Federal</option>
                <option value="ES">Espírito Santo</option>
                <option value="GO">Goiás</option>
                <option value="MA">Maranhão</option>
                <option value="MT">Mato Grosso</option>
                <option value="MS">Mato Grosso do Sul</option>
                <option value="MG">Minas Gerais</option>
                <option value="PA">Pará</option>
                <option value="PB">Paraíba</option>
                <option value="PR">Paraná</option>
                <option value="PE">Pernambuco</option>
                <option value="PI">Piauí</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="RN">Rio Grande do Norte</option>
                <option value="RS">Rio Grande do Sul</option>
                <option value="RO">Rondônia</option>
                <option value="RR">Roraima</option>
                <option value="SC">Santa Catarina</option>
                <option value="SP">São Paulo</option>
                <option value="SE">Sergipe</option>
                <option value="TO">Tocantins</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="municipio" class="form-label fw-semibold">Município</label>
              <input type="text" id="municipio" class="form-control" />
            </div>
            <div class="col-md-6">
              <label for="status" class="form-label fw-semibold">Status</label>
              <select id="status" class="form-select">
                <option value="Ativo">Ativo</option>
                <option value="Inativo">Inativo</option>
                <option value="Potencial">Potencial</option>
                <option value="Bloqueado">Bloqueado</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="possui_ie" class="form-label fw-semibold">Possui I.E.?</label>
              <select id="possui_ie" class="form-select">
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
                <option value="Isento">Isento</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="ie" class="form-label fw-semibold">Inscrição Estadual (I.E.)</label>
              <input type="text" id="ie" class="form-control" />
            </div>
            <div class="col-md-6">
              <label for="filial" class="form-label fw-semibold">Filial</label>
              <select id="filial" class="form-select">
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="empresa_matriz" class="form-label fw-semibold">Empresa Matriz</label>
              <input type="text" id="empresa_matriz" class="form-control" />
            </div>
            <div class="col-md-6">
              <label for="grupo" class="form-label fw-semibold">Grupo</label>
              <input type="text" id="grupo" class="form-control" />
            </div>
          </div>
          <input type="hidden" id="clienteIndex" />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-success">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Contêiner para toasts -->
  <div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="successToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          <i class="bi bi-check-circle-fill me-2"></i>
          <span id="successToastMessage"></span>
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Fechar"></button>
      </div>
    </div>
    <div id="errorToast" class="toast align-items-center text-white bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <span id="errorToastMessage"></span>
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Fechar"></button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="script.js" defer></script>
</body>
</html>