<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CRM PB</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <nav class="navbar navbar-light bg-light shadow-sm">
    <div class="container max-w-7xl d-flex align-items-center">
      <a class="navbar-brand font-bold text-gray-900" href="index.html">CRM PB</a>
      <div class="ms-auto d-flex gap-3" id="navbarLinks"></div>
    </div>
  </nav>
  
  <div class="container mt-8 max-w-7xl mx-auto px-4">
    <h1 class="text-3xl font-extrabold text-gray-900 mb-6">Cadastro de Clientes</h1>

    <div class="flex flex-wrap items-center mb-4 gap-3">
      <button class="btn btn-success flex items-center gap-2" onclick="abrirModal()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>
        Adicionar Cliente
      </button>

      <button class="btn btn-primary flex items-center gap-2" onclick="document.getElementById('fileInput').click()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-input"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M2 15h10"/><path d="m9 18 3-3-3-3"/></svg>
        Importar Clientes
      </button>
      <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="importarClientes(this.files)" />

      <button class="btn btn-danger flex items-center gap-2" onclick="exportarPDF()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-down"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M12 18v-6"/><path d="m9 15 3 3 3-3"/></svg>
        Exportar PDF
      </button>

      <button class="btn btn-warning flex items-center gap-2" onclick="exportarJSON()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-json-2"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M4 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1"/><path d="M8 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1"/></svg>
        Exportar JSON
      </button>
      
      <input type="text" id="filtroInput" placeholder="Buscar cliente..." 
        class="form-control rounded-md border border-gray-300 px-3 py-2 w-full max-w-xs"
        oninput="filtrarClientes()" />
    </div>

    <div class="table-container">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Código</th>
            <th>Nome/Apelido</th>
            <th>Razão Social</th>
            <th>CPF/CNPJ</th>
            <th>Regime Fiscal</th>
            <th>Situação</th>
            <th>Tipo Pessoa</th>
            <th>Estado</th>
            <th>Município</th>
            <th>Status</th>
            <th>Possui I.E.?</th>
            <th>I.E.</th>
            <th>Filial</th>
            <th>Matriz</th>
            <th>Grupo</th>
            <th>Segmento</th>
            <th>Data de Entrada</th>
            <th>Data de Saída</th>
            <th>Sistema</th>
            <th>Tipo de Serviço</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody id="clientesBody"></tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">
      <span id="paginacaoInfo"></span>
      <div>
        <button class="btn btn-outline-primary me-2" onclick="irParaPrimeiraPagina()">Primeira</button>
        <button class="btn btn-outline-primary me-2" onclick="irParaPaginaAnterior()">Anterior</button>
        <button class="btn btn-outline-primary me-2" onclick="irParaProximaPagina()">Próxima</button>
        <button class="btn btn-outline-primary" onclick="irParaUltimaPagina()">Última</button>
      </div>
    </div>
  </div>

  <div class="modal fade" id="clienteModal" tabindex="-1" aria-labelledby="clienteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="clienteModalLabel">Adicionar Cliente</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="clienteForm">
            <input type="hidden" id="clienteIndex">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="codigo" class="form-label">Código Interno *</label>
                <input type="text" class="form-control" id="codigo" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="nome" class="form-label">Nome/Apelido *</label>
                <input type="text" class="form-control" id="nome" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="razao_social" class="form-label">Razão Social</label>
                <input type="text" class="form-control" id="razao_social">
              </div>
              <div class="col-md-6 mb-3">
                <label for="cpf_cnpj" class="form-label">CPF/CNPJ *</label>
                <input type="text" class="form-control" id="cpf_cnpj" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="regime_fiscal" class="form-label">Regime Fiscal</label>
                <select class="form-select" id="regime_fiscal">
                  <option>Simples Nacional</option>
                  <option>Lucro Presumido</option>
                  <option>Lucro Real</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="situacao" class="form-label">Situação</label>
                <select class="form-select" id="situacao">
                  <option>Ativo</option>
                  <option>Inativo</option>
                  <option>Pendente</option>
                  <option>Bloqueado</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="tipo_pessoa" class="form-label">Tipo de Pessoa</label>
                <select class="form-select" id="tipo_pessoa">
                  <option>Física</option>
                  <option>Jurídica</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="estado" class="form-label">Estado</label>
                <select class="form-select" id="estado">
                  <option>Acre</option>
                  <option>Alagoas</option>
                  <option>Amapá</option>
                  <option>Amazonas</option>
                  <option>Bahia</option>
                  <option>Ceará</option>
                  <option>Distrito Federal</option>
                  <option>Espírito Santo</option>
                  <option>Goiás</option>
                  <option>Maranhão</option>
                  <option>Mato Grosso</option>
                  <option>Mato Grosso do Sul</option>
                  <option>Minas Gerais</option>
                  <option>Pará</option>
                  <option>Paraíba</option>
                  <option>Paraná</option>
                  <option>Pernambuco</option>
                  <option>Piauí</option>
                  <option>Rio de Janeiro</option>
                  <option>Rio Grande do Norte</option>
                  <option>Rio Grande do Sul</option>
                  <option>Rondônia</option>
                  <option>Roraima</option>
                  <option>Santa Catarina</option>
                  <option>São Paulo</option>
                  <option>Sergipe</option>
                  <option>Tocantins</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="municipio" class="form-label">Município</label>
                <input type="text" class="form-control" id="municipio">
              </div>
              <div class="col-md-6 mb-3">
                <label for="status" class="form-label">Status</label>
                <select class="form-select" id="status">
                  <option>Ativo</option>
                  <option>Inativo</option>
                  <option>Potencial</option>
                  <option>Bloqueado</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="possui_ie" class="form-label">Possui I.E.?</label>
                <select class="form-select" id="possui_ie">
                  <option>Sim</option>
                  <option>Não</option>
                  <option>Isento</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="ie" class="form-label">Inscrição Estadual (I.E.)</label>
                <input type="text" class="form-control" id="ie">
              </div>
              <div class="col-md-6 mb-3">
                <label for="filial" class="form-label">Filial</label>
                <select class="form-select" id="filial">
                  <option>Sim</option>
                  <option>Não</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="empresa_matriz" class="form-label">Empresa Matriz</label>
                <input type="text" class="form-control" id="empresa_matriz">
              </div>
              <div class="col-md-6 mb-3">
                <label for="grupo" class="form-label">Grupo</label>
                <input type="text" class="form-control" id="grupo">
              </div>
              <div class="col-md-6 mb-3">
                <label for="segmento" class="form-label">Segmento</label>
                <select class="form-select" id="segmento">
                  <option>Selecione</option>
                  <option>Comércio</option>
                  <option>Holding</option>
                  <option>Indústria</option>
                  <option>Locação</option>
                  <option>Produtor Rural</option>
                  <option>Serviço</option>
                  <option>Transporte</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="data_entrada" class="form-label">Data de Entrada</label>
                <input type="date" class="form-control" id="data_entrada">
              </div>
              <div class="col-md-6 mb-3">
                <label for="data_saida" class="form-label">Data de Saída</label>
                <input type="date" class="form-control" id="data_saida">
              </div>
              <div class="col-md-6 mb-3">
                <label for="sistema" class="form-label">Sistema</label>
                <select class="form-select" id="sistema">
                  <option>Selecione</option>
                  <option>Domínio</option>
                  <option>Protheus</option>
                  <option>Rodopar</option>
                  <option>SAP</option>
                  <option>Senior</option>
                  <option>Outros</option>
                </select>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Tipo de Serviço</label>
                <div id="tipo_servico">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Escrita Fiscal,Contábil,Departamento Pessoal" id="tipo_servico_combinado">
                    <label class="form-check-label" for="tipo_servico_combinado">Escrita Fiscal, Contábil, DP</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Escrita Fiscal" id="tipo_servico_escrita">
                    <label class="form-check-label" for="tipo_servico_escrita">Escrita Fiscal</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Departamento Pessoal" id="tipo_servico_dp">
                    <label class="form-check-label" for="tipo_servico_dp">Departamento Pessoal</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Departamento Pessoal Parcial" id="tipo_servico_dp_parcial">
                    <label class="form-check-label" for="tipo_servico_dp_parcial">Departamento Pessoal Parcial</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Societário" id="tipo_servico_societario">
                    <label class="form-check-label" for="tipo_servico_societario">Societário</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="BPO Financeiro" id="tipo_servico_bpo">
                    <label class="form-check-label" for="tipo_servico_bpo">BPO Financeiro</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Consultoria Tributária" id="tipo_servico_tributaria">
                    <label class="form-check-label" for="tipo_servico_tributaria">Consultoria Tributária</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Consultoria Jurídica" id="tipo_servico_juridica">
                    <label class="form-check-label" for="tipo_servico_juridica">Consultoria Jurídica</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Consultoria Reforma Tributária" id="tipo_servico_reforma">
                    <label class="form-check-label" for="tipo_servico_reforma">Consultoria Reforma Tributária</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Treinamento Fiscal e Financeiro" id="tipo_servico_treinamento">
                    <label class="form-check-label" for="tipo_servico_treinamento">Treinamento Fiscal e Financeiro</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Treinamento Fiscal" id="tipo_servico_treinamento_fiscal">
                    <label class="form-check-label" for="tipo_servico_treinamento_fiscal">Treinamento Fiscal</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Treinamento Financeiro" id="tipo_servico_treinamento_financeiro">
                    <label class="form-check-label" for="tipo_servico_treinamento_financeiro">Treinamento Financeiro</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="Serviço Extra" id="tipo_servico_extra">
                    <label class="form-check-label" for="tipo_servico_extra">Serviço Extra</label>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-primary" form="clienteForm">Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="successToast" class="toast bg-success text-white" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-body">
        <i class="bi bi-check-circle-fill me-2"></i>
        <span id="successToastMessage"></span>
      </div>
    </div>
    <div id="errorToast" class="toast bg-danger text-white" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-body">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <span id="errorToastMessage"></span>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>
  <script src="config.js"></script>
  <script src="auth.js"></script>
  <script src="script.js" defer></script>
</body>
</html>